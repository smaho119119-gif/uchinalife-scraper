import { GoogleGenerativeAI } from "@google/generative-ai";
import OpenAI from "openai";

const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY || '');
const openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY || '' });

// ============================================
// ãƒ¢ãƒ‡ãƒ«å®šç¾©ï¼ˆ2025å¹´11æœˆæœ€æ–°ï¼‰
// ============================================
export const AI_MODELS = {
    // ç”»åƒç”Ÿæˆãƒ¢ãƒ‡ãƒ«
    // ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: https://ai.google.dev/gemini-api/docs/gemini-3
    image: {
        'gemini-3-pro': {
            id: 'gemini-3-pro-image-preview',  // ç”»åƒç”Ÿæˆå°‚ç”¨ãƒ¢ãƒ‡ãƒ«
            name: 'Gemini 3 Pro Image (æœ€æ–°)',
            description: 'æœ€é«˜å“è³ªãƒ»4Kãƒ»æ—¥æœ¬èªãƒ†ã‚­ã‚¹ãƒˆå®Œå…¨å¯¾å¿œ',
            provider: 'google',
            default: true,
        },
        'gemini-2.5-flash': {
            id: 'gemini-2.5-flash-image-preview',
            name: 'Gemini 2.5 Flash Image',
            description: 'é«˜é€Ÿãƒ»ä½ã‚³ã‚¹ãƒˆ',
            provider: 'google',
            default: false,
        },
    },
    // ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆãƒ¢ãƒ‡ãƒ«
    text: {
        'gemini-3-pro': {
            id: 'gemini-3-pro-preview',
            name: 'Gemini 3 Pro (æœ€æ–°)',
            description: 'æœ€é«˜å“è³ªãƒ»å‹•çš„æ€è€ƒæ­è¼‰',
            provider: 'google',
            default: true,
        },
        'gemini-2.5-flash': {
            id: 'gemini-2.5-flash-preview-05-20',
            name: 'Gemini 2.5 Flash',
            description: 'é«˜é€Ÿãƒ»ä½ã‚³ã‚¹ãƒˆ',
            provider: 'google',
            default: false,
        },
        'gpt-4o-mini': {
            id: 'gpt-4o-mini',
            name: 'GPT-4o Mini',
            description: 'OpenAIãƒ»é«˜é€Ÿãƒ»ä½ã‚³ã‚¹ãƒˆ',
            provider: 'openai',
            default: false,
        },
    },
} as const;

export type ImageModelKey = keyof typeof AI_MODELS.image;
export type TextModelKey = keyof typeof AI_MODELS.text;

// ============================================
// ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
// ============================================
function getStyleDescription(style: string) {
    switch (style) {
        case 'luxury':
            return 'elegant gold and black with premium textures';
        case 'modern':
            return 'clean white and blue with minimalist design';
        case 'classic':
            return 'warm beige and brown with traditional elegance';
        case 'minimal':
            return 'monochrome with lots of white space';
        case 'handdrawn':
            return 'colorful hand-drawn illustration style with playful sketchy lines and vibrant colors';
        case '3d':
            return 'photorealistic 3D rendering with depth, shadows, and modern CGI aesthetic';
        case 'watercolor':
            return 'soft watercolor painting style with gentle color blends and artistic brush strokes';
        case 'neon':
            return 'vibrant neon colors with glowing effects, cyberpunk aesthetic, and electric atmosphere';
        case 'vintage':
            return 'retro vintage style with aged paper texture, sepia tones, and classic typography';
        case 'futuristic':
            return 'sleek futuristic design with metallic elements, holographic effects, and sci-fi aesthetic';
        case 'business':
            return 'professional Japanese business presentation style with clean infographics, charts, and structured layout';
        case 'anime':
            return 'Japanese anime illustration style with vibrant colors and expressive characters';
        default:
            return 'warm neutral tones';
    }
}

// ============================================
// ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆï¼ˆã‚»ãƒ¼ãƒ«ã‚¹ã‚³ãƒ”ãƒ¼ï¼‰
// ============================================
export async function generateSalesCopy(
    property: any,
    modelKey: TextModelKey = 'gemini-3-pro'
) {
    const modelConfig = AI_MODELS.text[modelKey];
    
    const prompt = `
ã‚ãªãŸã¯ãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¹ã®ä¸å‹•ç”£å–¶æ¥­ãƒãƒ³ã§ã™ã€‚ä»¥ä¸‹ã®ç‰©ä»¶æƒ…å ±ã‚’ã‚‚ã¨ã«ã€
é­…åŠ›çš„ã§èª¬å¾—åŠ›ã®ã‚ã‚‹ã‚»ãƒ¼ãƒ«ã‚¹ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ç‰©ä»¶æƒ…å ±:
- ã‚¿ã‚¤ãƒˆãƒ«: ${property.title}
- ä¾¡æ ¼: ${property.price}
- ã‚«ãƒ†ã‚´ãƒª: ${property.category_name_ja} / ${property.genre_name_ja}
- ä¼šç¤¾: ${property.company_name}
- è©³ç´°: ${JSON.stringify(property.property_data, null, 2)}

ä»¥ä¸‹ã®è¦ç´ ã‚’å«ã‚ã¦ãã ã•ã„:
1. ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ï¼ˆç›®ã‚’å¼•ãä¸€æ–‡ï¼‰
2. ç‰©ä»¶ã®ä¸»è¦ãªé­…åŠ›ãƒã‚¤ãƒ³ãƒˆï¼ˆ3-5ç‚¹ï¼‰
3. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå±¤ã¸ã®è¨´æ±‚
4. è¡Œå‹•å–šèµ·ï¼ˆCTAï¼‰

Markdownå½¢å¼ã§ã€è¦‹å‡ºã—ã‚„ç®‡æ¡æ›¸ãã‚’ä½¿ã£ã¦èª­ã¿ã‚„ã™ãä½œæˆã—ã¦ãã ã•ã„ã€‚
`;

    try {
        if (modelConfig.provider === 'openai') {
            // OpenAI (GPT-4o-mini)
            const response = await openai.chat.completions.create({
                model: modelConfig.id,
                messages: [{ role: 'user', content: prompt }],
                temperature: 0.7,
            });
            return response.choices[0]?.message?.content || '';
        } else {
            // Google Gemini
            const model = genAI.getGenerativeModel({ model: modelConfig.id });
            const result = await model.generateContent(prompt);
            const response = await result.response;
            return response.text();
        }
    } catch (error) {
        console.error(`${modelConfig.name} API Error:`, error);
        throw error;
    }
}

// ============================================
// ç”»åƒç”Ÿæˆï¼ˆç‰©ä»¶ç”»åƒä»˜ãï¼‰
// ============================================
export async function generatePropertyImageWithPhotos(options: {
    propertyData: any;
    propertyImages: Array<{ data: string, mimeType: string }>;
    staffPhoto: { data: string, mimeType: string } | null;
    mode: string;
    size: string;
    aspectRatio: string;
    style: string;
    template?: string;
    modelKey?: ImageModelKey;
}) {
    const modelKey = options.modelKey || 'gemini-3-pro';
    const modelConfig = AI_MODELS.image[modelKey];
    
    try {
        // å¤ã„SDKã‚’ä½¿ç”¨ï¼ˆresponseModalitiesã§ç”»åƒå‡ºåŠ›ã‚’æœ‰åŠ¹åŒ–ï¼‰
        const model = genAI.getGenerativeModel({
            model: modelConfig.id,
            generationConfig: {
                temperature: 1.0,
                // @ts-ignore - responseModalities is valid for Gemini image models
                responseModalities: ['TEXT', 'IMAGE'],
            }
        });

        // Build prompt based on mode and whether staff photo is included
        let prompt = '';
        
        // ç‰©ä»¶è©³ç´°æƒ…å ±ã‚’æŠ½å‡º
        const pd = options.propertyData.property_data || {};
        const propertyDetails = {
            title: options.propertyData.title || '',
            price: pd['å®¶è³ƒ'] || pd['ä¾¡æ ¼'] || options.propertyData.price || '',
            deposit: pd['æ•·é‡‘ï¼ç¤¼é‡‘'] || pd['æ•·é‡‘'] || '',
            layout: pd['é–“å–ã‚Š'] || '',
            address: pd['æ‰€åœ¨åœ°'] || pd['ä½æ‰€'] || '',
            parking: pd['é§è»Šå ´'] || '',
            area: pd['å°‚æœ‰é¢ç©'] || pd['é¢ç©'] || '',
            building: pd['å»ºç‰©æ§‹é€ '] || '',
            floor: pd['éƒ¨å±‹ç•ªå·'] || pd['éš'] || '',
            pet: pd['ãƒšãƒƒãƒˆ'] || '',
            security: pd['ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£'] || '',
            equipment: pd['å®¶å…·ãƒ»å®¶é›»'] || pd['è¨­å‚™'] || '',
            bath: pd['ãƒã‚¹ãƒ»ãƒˆã‚¤ãƒ¬'] || '',
            kitchen: pd['ã‚­ãƒƒãƒãƒ³'] || '',
            storage: pd['åç´'] || '',
            internet: pd['æ”¾é€ãƒ»é€šä¿¡'] || '',
            school: pd['å°å­¦æ ¡'] || '',
            company: pd['ä¸å‹•ç”£ä¼šç¤¾'] || options.propertyData.company_name || '',
            remarks: pd['å‚™è€ƒ'] || '',
        };

        // ä¸»è¦ãƒã‚¤ãƒ³ãƒˆã‚’æŠ½å‡ºï¼ˆç©ºã§ãªã„ã‚‚ã®ã ã‘ï¼‰
        const highlights = [
            propertyDetails.layout && `é–“å–ã‚Š: ${propertyDetails.layout}`,
            propertyDetails.price && `å®¶è³ƒ: ${propertyDetails.price}`,
            propertyDetails.deposit && `æ•·é‡‘/ç¤¼é‡‘: ${propertyDetails.deposit}`,
            propertyDetails.parking && `é§è»Šå ´: ${propertyDetails.parking}`,
            propertyDetails.security && `ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: ${propertyDetails.security}`,
            propertyDetails.pet && `ãƒšãƒƒãƒˆ: ${propertyDetails.pet}`,
        ].filter(Boolean).slice(0, 6);

        const template = options.template || 'standard';
        
        console.log(`Processing template: ${template}, mode: ${options.mode}, hasStaffPhoto: ${!!options.staffPhoto}`);

        // ===== ææ¡ˆæ›¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆç´™è³‡æ–™ç”¨ï¼‰ =====
        if (template.startsWith('proposal_')) {
            console.log('Using proposal template prompt');
            const templateType = template.replace('proposal_', '');
            
            let layoutInstructions = '';
            
            if (templateType === 'card') {
                // ç‰©ä»¶ã‚«ãƒ¼ãƒ‰å‹
                layoutInstructions = `
ã€ç‰©ä»¶ã‚«ãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘ååˆºã‚µã‚¤ã‚ºã®ç‰©ä»¶ç´¹ä»‹ã‚«ãƒ¼ãƒ‰

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚             â”‚  ğŸ  ${propertyDetails.title}   â”‚
â”‚  â”‚  ç‰©ä»¶å†™çœŸ    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  â”‚   (å¤§)      â”‚  ğŸ’° ${propertyDetails.price}    â”‚
â”‚  â”‚             â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  ğŸ“ ${propertyDetails.address} â”‚
â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ğŸ     â”‚ â”‚ğŸš—   â”‚ â”‚ğŸ•   â”‚ â”‚ğŸ”   â”‚     â”‚
â”‚  â”‚é–“å–ã‚Šâ”‚ â”‚é§è»Šå ´â”‚ â”‚ãƒšãƒƒãƒˆâ”‚ â”‚ã‚»ã‚­ãƒ¥ãƒªâ”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                        â”‚
â”‚  ğŸ¢ ${propertyDetails.company}         â”‚
â”‚  ğŸ“ ãŠå•ã„åˆã‚ã› â–¶                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

- ã‚·ãƒ³ãƒ—ãƒ«ã§è¦‹ã‚„ã™ã„ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³
- ç‰©ä»¶å†™çœŸã‚’å·¦ä¸Šã«å¤§ããé…ç½®
- ä¸»è¦æƒ…å ±ã‚’å³å´ã«
- è¨­å‚™ã¯ã‚¢ã‚¤ã‚³ãƒ³å½¢å¼ã§ä¸‹éƒ¨ã«ä¸¦ã¹ã‚‹`;
            } else if (templateType === 'compare') {
                // æ¯”è¼ƒè¡¨ä»˜ã
                layoutInstructions = `
ã€æ¯”è¼ƒè¡¨ä»˜ããƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘è²»ç”¨å†…è¨³ãŒä¸€ç›®ã§åˆ†ã‹ã‚‹

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ  ${propertyDetails.title}                     â”‚
â”‚  â˜…â˜…â˜… ${propertyDetails.price} â˜…â˜…â˜…              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                 â”‚  â”‚ ğŸ“Š è²»ç”¨è©³ç´°    â”‚â”‚
â”‚  â”‚    ç‰©ä»¶å†™çœŸ     â”‚  â”‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚                 â”‚  â”‚ â”‚æ•·é‡‘â”‚â—‹â—‹â—‹â”‚   â”‚â”‚
â”‚  â”‚                 â”‚  â”‚ â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤   â”‚â”‚
â”‚  â”‚                 â”‚  â”‚ â”‚ç¤¼é‡‘â”‚â—‹â—‹â—‹â”‚   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤   â”‚â”‚
â”‚                       â”‚ â”‚ä»²ä»‹â”‚â—‹â—‹â—‹â”‚   â”‚â”‚
â”‚  ğŸ“ ${propertyDetails.address}  â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  ğŸ  ${propertyDetails.layout}   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  ğŸš— ${propertyDetails.parking}                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¢ ${propertyDetails.company} â”‚ ğŸ“ ãŠå•ã„åˆã‚ã› â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

- å³å´ã«è²»ç”¨æ¯”è¼ƒè¡¨
- åˆæœŸè²»ç”¨ã®åˆè¨ˆã‚‚è¡¨ç¤º
- æ•°å­—ã¯è¦‹ã‚„ã™ãå¤§ãã‚ã«`;
            } else if (templateType === 'flow') {
                // ãƒ•ãƒ­ãƒ¼å‹
                layoutInstructions = `
ã€ãƒ•ãƒ­ãƒ¼å‹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘æƒ…å ±ã‚’æ®µéšçš„ã«è¡¨ç¤º

        ${propertyDetails.title}
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ğŸ’° ${propertyDetails.price}             â”‚
â”‚          ï¼ˆæœ€é‡è¦ãƒ»æœ€å¤§ã‚µã‚¤ã‚ºï¼‰                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“æ‰€åœ¨åœ°  â”‚ â†’ â”‚ ğŸ é–“å–ã‚Š  â”‚ â†’ â”‚ ğŸš—é§è»Šå ´  â”‚
â”‚ ${propertyDetails.address} â”‚    â”‚ ${propertyDetails.layout} â”‚    â”‚ ${propertyDetails.parking} â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¨­å‚™: ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ â”‚ ğŸ› ãƒã‚¹ â”‚ ğŸ³ ã‚­ãƒƒãƒãƒ³ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¢ ${propertyDetails.company}                  â”‚
â”‚  ğŸ“ ãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰ â†’                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

- çŸ¢å°ã§æƒ…å ±ã®æµã‚Œã‚’è¡¨ç¾
- ä¸Šã‹ã‚‰ä¸‹ã¸èª­ã¿é€²ã‚ã‚‹æ§‹é€ 
- å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯æ˜ç¢ºã«åŒºåˆ‡ã‚‹`;
            } else if (templateType === 'grid') {
                // ã‚°ãƒªãƒƒãƒ‰å‹
                layoutInstructions = `
ã€ã‚°ãƒªãƒƒãƒ‰å‹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘æƒ…å ±ã‚’æ•´ç„¶ã¨é…ç½®

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              â”‚              â”‚              â”‚
â”‚   ç‰©ä»¶å†™çœŸ1   â”‚   ç‰©ä»¶å†™çœŸ2   â”‚   ç‰©ä»¶å†™çœŸ3   â”‚
â”‚              â”‚              â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ  ${propertyDetails.title}                    â”‚
â”‚  ğŸ’° ${propertyDetails.price}                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“æ‰€åœ¨åœ°      â”‚ ğŸ é–“å–ã‚Š      â”‚ ğŸš—é§è»Šå ´      â”‚
â”‚ ${propertyDetails.address} â”‚ ${propertyDetails.layout} â”‚ ${propertyDetails.parking} â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ•ãƒšãƒƒãƒˆ      â”‚ ğŸ”ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ â”‚ ğŸ’´æ•·é‡‘/ç¤¼é‡‘   â”‚
â”‚ ${propertyDetails.pet} â”‚ ${propertyDetails.security} â”‚ ${propertyDetails.deposit} â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¢ ${propertyDetails.company} ğŸ“ ãŠå•ã„åˆã‚ã›  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

- 3ã‚«ãƒ©ãƒ ã®ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
- ä¸Šéƒ¨ã«å†™çœŸã‚®ãƒ£ãƒ©ãƒªãƒ¼
- ä¸‹éƒ¨ã«æƒ…å ±ã‚°ãƒªãƒƒãƒ‰
- æ•´ç„¶ã¨ã—ãŸå°è±¡`;
            }
            
            // ã‚¹ã‚¿ãƒƒãƒ•å†™çœŸãŒã‚ã‚‹å ´åˆã®è¿½åŠ æŒ‡ç¤º
            const staffInstructions = options.staffPhoto ? `
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€ã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã®åŠ å·¥ãƒ»é…ç½® - é‡è¦ã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
æä¾›ã•ã‚ŒãŸã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«åŠ å·¥ãƒ»é…ç½®ã—ã¦ãã ã•ã„ï¼š

â–  ãƒãƒ¼ã‚ºãƒ»é›°å›²æ°—ã®åŠ å·¥ï¼ˆå¿…é ˆï¼‰
- ã‚¹ã‚¿ãƒƒãƒ•ãŒã€Œç‰©ä»¶ã‚’æ¡ˆå†…ã—ã¦ã„ã‚‹ã€é›°å›²æ°—ã«åŠ å·¥
- æ‰‹ã‚’ç‰©ä»¶å†™çœŸã«å‘ã‘ã¦å·®ã—å‡ºã—ã€æ¡ˆå†…ã—ã¦ã„ã‚‹ãƒãƒ¼ã‚ºã«å¤‰æ›´
- æ˜ã‚‹ã„ç¬‘é¡”ã§è¦ªã—ã¿ã‚„ã™ã„è¡¨æƒ…ã«ï¼ˆå¿…ãšç¬‘é¡”ã«ã™ã‚‹ï¼‰
- æ­¯ã‚’è¦‹ã›ãŸè‡ªç„¶ãªç¬‘é¡”ãŒæœ›ã¾ã—ã„
- ä¸å‹•ç”£å–¶æ¥­ã‚¹ã‚¿ãƒƒãƒ•ã¨ã—ã¦ç‰©ä»¶ã‚’ç´¹ä»‹ã—ã¦ã„ã‚‹ã‚ˆã†ãªè‡ªç„¶ãªãƒãƒ¼ã‚º

â–  é…ç½®
- å³ä¸‹ã«é…ç½®ï¼ˆå…¨ä½“ã®20-25%ç¨‹åº¦ã®ã‚µã‚¤ã‚ºï¼‰
- å††å½¢ã®ç™½ã„æ ã§å›²ã‚€
- ã‚¹ã‚¿ãƒƒãƒ•ã®ä¸ŠåŠèº«ãŒè¦‹ãˆã‚‹ã‚µã‚¤ã‚º
- èƒŒæ™¯ã¨åŒºåˆ¥ã§ãã‚‹ã‚ˆã†ç™½ã„ç¸å–ã‚Šã‚’è¿½åŠ 

â–  æ¡ˆå†…ãƒãƒ¼ã‚ºã®ä¾‹
- ç‰‡æ‰‹ã‚’ç‰©ä»¶å†™çœŸã®æ–¹å‘ã«ä¼¸ã°ã—ã€ã€Œã“ã¡ã‚‰ã®ç‰©ä»¶ã§ã™ã€ã¨æ¡ˆå†…ã—ã¦ã„ã‚‹ãƒãƒ¼ã‚º
- ã‚‚ã—ãã¯ä¸¡æ‰‹ã‚’åºƒã’ã¦ç‰©ä»¶å…¨ä½“ã‚’ç´¹ä»‹ã™ã‚‹ãƒãƒ¼ã‚º
- è¦ªã—ã¿ã‚„ã™ã„æ˜ã‚‹ã„ç¬‘é¡”ã§ï¼ˆå¿…ãšç¬‘é¡”ï¼‰

ã€å¹ãå‡ºã—ã‚³ãƒ¡ãƒ³ãƒˆ - AIã§ç”Ÿæˆã€‘
ç‰©ä»¶ã®ç‰¹å¾´ã‚’åˆ†æã—ã¦ã€é­…åŠ›çš„ãªä¸€è¨€ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ—¥æœ¬èªã§ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
ä¾‹ï¼š
- é§è»Šå ´ãŒåºƒã„å ´åˆ â†’ã€Œé§è»Šå ´åºƒã€…ï¼ã€
- ãƒšãƒƒãƒˆå¯ã®å ´åˆ â†’ã€ŒãƒšãƒƒãƒˆOKï¼ã€
- ä¾¡æ ¼ãŒãŠå¾—ãªå ´åˆ â†’ã€ŒãŠå¾—ãªç‰©ä»¶ï¼ã€
- ç«‹åœ°ãŒè‰¯ã„å ´åˆ â†’ã€Œä¾¿åˆ©ãªç«‹åœ°ï¼ã€
- é–“å–ã‚ŠãŒåºƒã„å ´åˆ â†’ã€Œåºƒã€…ç©ºé–“ï¼ã€
- æ–°ç¯‰ãƒ»ç¯‰æµ…ã®å ´åˆ â†’ã€Œãã‚Œã„ãªç‰©ä»¶ï¼ã€
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å……å®Ÿ â†’ã€Œå®‰å¿ƒã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ã€

ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã¦ã€æœ€ã‚‚é­…åŠ›çš„ãªãƒã‚¤ãƒ³ãƒˆã‚’çŸ­ã„æ—¥æœ¬èªï¼ˆ10æ–‡å­—ä»¥å†…ï¼‰ã§è¡¨ç¾ã—ã¦ãã ã•ã„ã€‚
` : '';

            // è¤‡æ•°ç”»åƒä½¿ç”¨ã®æŒ‡ç¤º
            const multiImageInstructions = options.propertyImages.length > 1 ? `
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€è¤‡æ•°ç”»åƒã®ä½¿ç”¨ - é‡è¦ã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
æä¾›ã•ã‚ŒãŸ${options.propertyImages.length}æšã®ç‰©ä»¶å†™çœŸã‚’å…¨ã¦ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚
- ãƒ¡ã‚¤ãƒ³å†™çœŸã‚’å¤§ããé…ç½®
- ã‚µãƒ–å†™çœŸã‚’å°ã•ãè¤‡æ•°é…ç½®ï¼ˆã‚³ãƒ©ãƒ¼ã‚¸ãƒ¥é¢¨ã¾ãŸã¯ã‚®ãƒ£ãƒ©ãƒªãƒ¼é¢¨ï¼‰
- å…¨ã¦ã®å†™çœŸãŒè¦‹ãˆã‚‹ã‚ˆã†ã«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
` : '';

            prompt = `
æ—¥æœ¬èªã®ä¸å‹•ç”£ææ¡ˆæ›¸ç”¨ã‚¤ãƒ³ãƒ•ã‚©ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
ãƒ“ã‚¸ãƒã‚¹ææ¡ˆæ›¸ã‚„ç´™è³‡æ–™ã«ä½¿ãˆã‚‹ã€ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³ã§ã™ã€‚
${options.staffPhoto ? 'ã‚¹ã‚¿ãƒƒãƒ•ãŒç‰©ä»¶ã‚’ç´¹ä»‹ã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ã§ä½œæˆã—ã¦ãã ã•ã„ã€‚' : ''}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ç‰©ä»¶å: ${propertyDetails.title}
å®¶è³ƒ: ${propertyDetails.price}
æ•·é‡‘/ç¤¼é‡‘: ${propertyDetails.deposit}
é–“å–ã‚Š: ${propertyDetails.layout}
æ‰€åœ¨åœ°: ${propertyDetails.address}
é§è»Šå ´: ${propertyDetails.parking}
ãƒšãƒƒãƒˆ: ${propertyDetails.pet}
å»ºç‰©æ§‹é€ : ${propertyDetails.building}
ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: ${propertyDetails.security}
è¨­å‚™: ${propertyDetails.equipment}
ãƒã‚¹ãƒ»ãƒˆã‚¤ãƒ¬: ${propertyDetails.bath}
ã‚­ãƒƒãƒãƒ³: ${propertyDetails.kitchen}
åç´: ${propertyDetails.storage}
ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ: ${propertyDetails.internet}
ä¸å‹•ç”£ä¼šç¤¾: ${propertyDetails.company}

${layoutInstructions}
${staffInstructions}
${multiImageInstructions}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€ãƒ‡ã‚¶ã‚¤ãƒ³ä»•æ§˜ã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã‚«ãƒ©ãƒ¼:
- ãƒ¡ã‚¤ãƒ³: ç´ºè‰² (#1a365d)
- ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ: ã‚´ãƒ¼ãƒ«ãƒ‰ (#d69e2e)ã€æ°´è‰² (#4299e1)
- èƒŒæ™¯: ç™½ (#ffffff)
- ãƒ†ã‚­ã‚¹ãƒˆ: ãƒ€ãƒ¼ã‚¯ã‚°ãƒ¬ãƒ¼ (#2d3748)

ãƒ•ã‚©ãƒ³ãƒˆ:
- ã‚¿ã‚¤ãƒˆãƒ«: å¤ªå­—ã€å¤§ãã‚
- ä¾¡æ ¼: æœ€å¤§ã‚µã‚¤ã‚ºã€ç›®ç«‹ã¤è‰²
- æœ¬æ–‡: èª­ã¿ã‚„ã™ã„ã‚µã‚¤ã‚º

è¦ç´ :
- è§’ä¸¸ã®ã‚«ãƒ¼ãƒ‰
- ã‚¢ã‚¤ã‚³ãƒ³ä»˜ãæƒ…å ±
- é©åº¦ãªä½™ç™½
- ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªå°è±¡

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€å¿…é ˆè¡¨ç¤ºãƒ†ã‚­ã‚¹ãƒˆï¼ˆæ­£ç¢ºã«æ—¥æœ¬èªã§ï¼‰ã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€Œ${propertyDetails.title}ã€
ã€Œ${propertyDetails.price}ã€
ã€Œ${propertyDetails.layout}ã€
ã€Œ${propertyDetails.address}ã€
ã€Œ${propertyDetails.parking}ã€
ã€Œ${propertyDetails.company}ã€
ã€ŒãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰ã€
${options.staffPhoto ? '+ ã‚¹ã‚¿ãƒƒãƒ•å¹ãå‡ºã—: ç‰©ä»¶ã®é­…åŠ›ã‚’è¡¨ã™çŸ­ã„ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆAIãŒç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ç”Ÿæˆã€10æ–‡å­—ä»¥å†…ï¼‰' : ''}

ã€é‡è¦ã€‘
- å…¨ãƒ†ã‚­ã‚¹ãƒˆã¯æ­£ç¢ºãªæ—¥æœ¬èªã§è¡¨ç¤º
- æ–‡å­—åŒ–ã‘ãªã—
- å°åˆ·å¯èƒ½ãªå“è³ª
- ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”: ${options.aspectRatio}
${options.staffPhoto ? '- ã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã‚’å¿…ãšå«ã‚ã€å¹ãå‡ºã—ã«ã¯ç‰©ä»¶ã®é­…åŠ›ã‚’è¡¨ã™ã‚³ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆ' : ''}
${options.propertyImages.length > 1 ? `- æä¾›ã•ã‚ŒãŸ${options.propertyImages.length}æšã®ç‰©ä»¶å†™çœŸã‚’å…¨ã¦ä½¿ç”¨` : ''}
`;
        }
        // ===== ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆãƒ¢ãƒ¼ãƒ‰åˆ¥å‡¦ç†ï¼‰ =====
        else if (template === 'standard') {
            console.log(`Using standard template with mode: ${options.mode}`);
            
            // ãƒ¢ãƒ¼ãƒ‰åˆ¥ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæŒ‡ç¤º
            let modeInstructions = '';
            if (options.mode === 'youtube') {
                modeInstructions = `
ã€YouTubeã‚µãƒ ãƒã‚¤ãƒ«é¢¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘
- 16:9ã®ãƒ¯ã‚¤ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- å¤§ããç›®ã‚’å¼•ãã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—ï¼ˆå¤ªå­—ã€ç¸å–ã‚Šä»˜ãï¼‰
- ç‰©ä»¶å†™çœŸã‚’èƒŒæ™¯å…¨é¢ã«é…ç½®
- ä¾¡æ ¼ã‚’ç›®ç«‹ã¤ä½ç½®ã«å¤§ããè¡¨ç¤ºï¼ˆé»„è‰²ã‚„ã‚ªãƒ¬ãƒ³ã‚¸ãªã©ã®æ³¨ç›®è‰²ï¼‰
- ã€Œè©³ç´°ã¯ã“ã¡ã‚‰ã€ãªã©ã®CTAãƒ†ã‚­ã‚¹ãƒˆ`;
            } else if (options.mode === 'stories') {
                modeInstructions = `
ã€Instagramã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚ºé¢¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘
- 9:16ã®ç¸¦é•·ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- ç‰©ä»¶å†™çœŸã‚’å…¨é¢ã«é…ç½®
- ä¸Šéƒ¨ã«ã‚¿ã‚¤ãƒˆãƒ«ã€ä¸­å¤®ã«ä¾¡æ ¼
- ä¸‹éƒ¨ã«ã€Œã‚¹ãƒ¯ã‚¤ãƒ—ã‚¢ãƒƒãƒ—ã€ãªã©ã®CTAã‚¨ãƒªã‚¢
- ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚ºã«é©ã—ãŸãƒãƒƒãƒ—ãªãƒ‡ã‚¶ã‚¤ãƒ³`;
            } else if (options.mode === 'instagram') {
                modeInstructions = `
ã€InstagramæŠ•ç¨¿é¢¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘
- 1:1ã®æ­£æ–¹å½¢ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- ç‰©ä»¶å†™çœŸã‚’ãƒ¡ã‚¤ãƒ³ã«é…ç½®
- æ´—ç·´ã•ã‚ŒãŸã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£
- ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°é¢¨ã®è£…é£¾ã‚‚å¯
- ã‚¤ãƒ³ã‚¹ã‚¿æ˜ ãˆã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªãƒ‡ã‚¶ã‚¤ãƒ³`;
            } else {
                // sns_bannerï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
                modeInstructions = `
ã€SNSãƒãƒŠãƒ¼é¢¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘
- ç‰©ä»¶å†™çœŸã‚’èƒŒæ™¯ã«é…ç½®
- ä¸Šéƒ¨ã«ç‰©ä»¶åï¼ˆå¤§ããèª­ã¿ã‚„ã™ãï¼‰
- ä¸­å¤®ã¾ãŸã¯ç›®ç«‹ã¤ä½ç½®ã«ä¾¡æ ¼
- ä¸‹éƒ¨ã«ç‰©ä»¶è©³ç´°ã¨å•ã„åˆã‚ã›ãƒœã‚¿ãƒ³
- SNSåºƒå‘Šã«é©ã—ãŸãƒ‡ã‚¶ã‚¤ãƒ³`;
            }
            
            const staffSection = options.staffPhoto ? `
ã€ã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã®åŠ å·¥ãƒ»é…ç½®ã€‘
- æä¾›ã•ã‚ŒãŸã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã‚’ã€Œæ¡ˆå†…ãƒãƒ¼ã‚ºã€ã«åŠ å·¥
- æ‰‹ã‚’ç‰©ä»¶ã®æ–¹å‘ã«å·®ã—å‡ºã—ã€æ¡ˆå†…ã—ã¦ã„ã‚‹é›°å›²æ°—ã«
- æ˜ã‚‹ã„ç¬‘é¡”ã§è¦ªã—ã¿ã‚„ã™ã„è¡¨æƒ…ï¼ˆå¿…ãšç¬‘é¡”ã«ã™ã‚‹ï¼‰
- å³ä¸‹ã«é…ç½®ã€å††å½¢ã®ç™½ã„æ ã§å›²ã‚€
- å¹ãå‡ºã—ã«ç‰©ä»¶ã®é­…åŠ›ã‚³ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆï¼ˆ10æ–‡å­—ä»¥å†…ï¼‰` : '';

            prompt = `
æ—¥æœ¬èªã®ä¸å‹•ç”£ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ç”»åƒã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
${options.staffPhoto ? 'ã‚¹ã‚¿ãƒƒãƒ•ãŒç‰©ä»¶ã‚’ç´¹ä»‹ã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ã§ã€‚' : ''}

ã€ç‰©ä»¶æƒ…å ±ã€‘
ğŸ“ ç‰©ä»¶å: ${propertyDetails.title}
ğŸ’° å®¶è³ƒ: ${propertyDetails.price}
ğŸ  é–“å–ã‚Š: ${propertyDetails.layout}
ğŸ“ æ‰€åœ¨åœ°: ${propertyDetails.address}
ğŸš— é§è»Šå ´: ${propertyDetails.parking}
ğŸ• ãƒšãƒƒãƒˆ: ${propertyDetails.pet}
ğŸ¢ ä¸å‹•ç”£ä¼šç¤¾: ${propertyDetails.company}

${modeInstructions}
${staffSection}

ã€è¡¨ç¤ºã™ã‚‹æ–‡å­—ï¼ˆæ­£ç¢ºã«æ—¥æœ¬èªã§ï¼‰ã€‘
- ã€Œ${propertyDetails.title}ã€
- ã€Œ${propertyDetails.price}ã€ï¼ˆæœ€ã‚‚ç›®ç«‹ã¤ã‚ˆã†ã«ï¼‰
- ã€Œ${propertyDetails.layout}ã€
- ã€Œ${propertyDetails.parking}ã€
- ã€ŒãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰ã€
${options.staffPhoto ? '- ã‚¹ã‚¿ãƒƒãƒ•å¹ãå‡ºã—: ç‰©ä»¶ã®é­…åŠ›ã‚’è¡¨ã™çŸ­ã„ã‚³ãƒ¡ãƒ³ãƒˆ' : ''}

ã€ã‚¹ã‚¿ã‚¤ãƒ«ã€‘
${getStyleDescription(options.style)}
- ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªä¸å‹•ç”£åºƒå‘Šãƒ‡ã‚¶ã‚¤ãƒ³
- ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”: ${options.aspectRatio}

ã€é‡è¦ã€‘
- å…¨ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆã¯æ­£ç¢ºãªæ—¥æœ¬èªã§è¡¨ç¤º
- æ–‡å­—ãŒèª­ã¿ã‚„ã™ã„ã‚ˆã†ã«ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã‚’ç¢ºä¿
${options.staffPhoto ? '- ã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã¯ã€Œæ¡ˆå†…ãƒãƒ¼ã‚ºã€ã«åŠ å·¥ï¼ˆæ‰‹ã‚’å·®ã—å‡ºã—ã¦ç‰©ä»¶ã‚’ç´¹ä»‹ã—ã¦ã„ã‚‹é›°å›²æ°—ï¼‰' : ''}
${options.propertyImages.length > 1 ? `- æä¾›ã•ã‚ŒãŸ${options.propertyImages.length}æšã®ç‰©ä»¶å†™çœŸã‚’ä½¿ç”¨` : ''}
`;
        }
        // ===== ã‚³ãƒ©ãƒ¼ã‚¸ãƒ¥ãƒ»é›‘èªŒé¢¨ãƒ»ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ =====
        else if (template === 'collage' || template === 'magazine' || template === 'overlay') {
            console.log(`Using ${template} template prompt`);
            
            let templateInstructions = '';
            if (template === 'collage') {
                templateInstructions = `
ã€ã‚³ãƒ©ãƒ¼ã‚¸ãƒ¥ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘
- è¤‡æ•°ã®ç‰©ä»¶å†™çœŸã‚’ã‚³ãƒ©ãƒ¼ã‚¸ãƒ¥é¢¨ã«é…ç½®
- å†™çœŸåŒå£«ãŒå°‘ã—é‡ãªã‚Šåˆã†ã‚¹ã‚¿ã‚¤ãƒ«
- æ–œã‚ã«é…ç½®ã—ãŸã‚Šã€ã‚µã‚¤ã‚ºã‚’å¤‰ãˆã¦å‹•ãã‚’å‡ºã™
- ä¸­å¤®ã«ä¾¡æ ¼ã¨ç‰©ä»¶åã‚’å¤§ããé…ç½®`;
            } else if (template === 'magazine') {
                templateInstructions = `
ã€é›‘èªŒé¢¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘
- ä¸å‹•ç”£é›‘èªŒã®1ãƒšãƒ¼ã‚¸ã®ã‚ˆã†ãªãƒ‡ã‚¶ã‚¤ãƒ³
- å¤§ããªãƒ¡ã‚¤ãƒ³å†™çœŸã¨å°ã•ãªã‚µãƒ–å†™çœŸ
- æ´—ç·´ã•ã‚ŒãŸã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£
- è¦‹å‡ºã—ã€æœ¬æ–‡ã€ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã®éšå±¤æ§‹é€ `;
            } else if (template === 'overlay') {
                templateInstructions = `
ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘
- ç‰©ä»¶å†™çœŸã‚’å…¨é¢ã«é…ç½®
- åŠé€æ˜ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã§æƒ…å ±ã‚’é‡ã­ã‚‹
- ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœã§æ–‡å­—ã‚’èª­ã¿ã‚„ã™ã
- å†™çœŸã®é­…åŠ›ã‚’æœ€å¤§é™ã«æ´»ã‹ã™`;
            }

            const staffSection = options.staffPhoto ? `
ã€ã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã®åŠ å·¥ãƒ»é…ç½® - é‡è¦ã€‘
æä¾›ã•ã‚ŒãŸã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«åŠ å·¥ã—ã¦ãã ã•ã„ï¼š
â–  ãƒãƒ¼ã‚ºã®åŠ å·¥ï¼ˆå¿…é ˆï¼‰
- ã‚¹ã‚¿ãƒƒãƒ•ãŒã€Œç‰©ä»¶ã‚’æ¡ˆå†…ã—ã¦ã„ã‚‹ã€é›°å›²æ°—ã«åŠ å·¥
- æ‰‹ã‚’ç‰©ä»¶å†™çœŸã«å‘ã‘ã¦å·®ã—å‡ºã—ã€æ¡ˆå†…ã—ã¦ã„ã‚‹ãƒãƒ¼ã‚ºã«å¤‰æ›´
- æ˜ã‚‹ã„ç¬‘é¡”ã§è¦ªã—ã¿ã‚„ã™ã„è¡¨æƒ…ï¼ˆå¿…ãšç¬‘é¡”ã«ã™ã‚‹ï¼‰
- æ­¯ã‚’è¦‹ã›ãŸè‡ªç„¶ãªç¬‘é¡”ãŒæœ›ã¾ã—ã„
- ç‰‡æ‰‹ã‚’ç‰©ä»¶ã®æ–¹å‘ã«ä¼¸ã°ã—ã€Œã“ã¡ã‚‰ã®ç‰©ä»¶ã§ã™ã€ã¨æ¡ˆå†…ã—ã¦ã„ã‚‹ãƒãƒ¼ã‚º
â–  é…ç½®
- å³ä¸‹ã«é…ç½®ã€å††å½¢ã®ç™½ã„æ ã§å›²ã‚€
- å¹ãå‡ºã—ã«ç‰©ä»¶ã®é­…åŠ›ã‚’è¡¨ã™çŸ­ã„ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ—¥æœ¬èªã§ç”Ÿæˆ
  ï¼ˆä¾‹ï¼šã€Œé§è»Šå ´åºƒã€…ï¼ã€ã€ŒãƒšãƒƒãƒˆOKï¼ã€ã€Œä¾¿åˆ©ãªç«‹åœ°ï¼ã€ãªã©ï¼‰` : '';

            const multiImageSection = options.propertyImages.length > 1 ? `
ã€è¤‡æ•°ç”»åƒã®ä½¿ç”¨ - é‡è¦ã€‘
æä¾›ã•ã‚ŒãŸ${options.propertyImages.length}æšã®ç‰©ä»¶å†™çœŸã‚’å…¨ã¦ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚
- ãƒ¡ã‚¤ãƒ³å†™çœŸã‚’å¤§ããé…ç½®
- ã‚µãƒ–å†™çœŸã‚’å°ã•ãé…ç½®ï¼ˆã‚³ãƒ©ãƒ¼ã‚¸ãƒ¥é¢¨ï¼‰` : '';

            prompt = `
æ—¥æœ¬èªã®ä¸å‹•ç”£ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ç”»åƒã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
${options.staffPhoto ? 'ã‚¹ã‚¿ãƒƒãƒ•ãŒç‰©ä»¶ã‚’ç´¹ä»‹ã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ã§ã€‚' : ''}

ã€ç‰©ä»¶æƒ…å ±ã€‘
ğŸ“ ç‰©ä»¶å: ${propertyDetails.title}
ğŸ’° å®¶è³ƒ: ${propertyDetails.price}
ğŸ  é–“å–ã‚Š: ${propertyDetails.layout}
ğŸ“ æ‰€åœ¨åœ°: ${propertyDetails.address}
ğŸš— é§è»Šå ´: ${propertyDetails.parking}
ğŸ• ãƒšãƒƒãƒˆ: ${propertyDetails.pet}
ğŸ¢ ä¸å‹•ç”£ä¼šç¤¾: ${propertyDetails.company}

${templateInstructions}
${staffSection}
${multiImageSection}

ã€è¡¨ç¤ºã™ã‚‹æ–‡å­—ï¼ˆæ­£ç¢ºã«æ—¥æœ¬èªã§ï¼‰ã€‘
- ã€Œ${propertyDetails.title}ã€
- ã€Œ${propertyDetails.price}ã€ï¼ˆæœ€ã‚‚ç›®ç«‹ã¤ã‚ˆã†ã«ï¼‰
- ã€Œ${propertyDetails.layout}ã€
- ã€Œ${propertyDetails.parking}ã€
- ã€ŒãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰ã€
${options.staffPhoto ? '- ã‚¹ã‚¿ãƒƒãƒ•å¹ãå‡ºã—: ç‰©ä»¶ã®é­…åŠ›ã‚’è¡¨ã™çŸ­ã„ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆAIãŒç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ç”Ÿæˆï¼‰' : ''}

ã€ã‚¹ã‚¿ã‚¤ãƒ«ã€‘
${getStyleDescription(options.style)}
- ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªä¸å‹•ç”£åºƒå‘Šãƒ‡ã‚¶ã‚¤ãƒ³
- ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”: ${options.aspectRatio}

ã€é‡è¦ã€‘
- å…¨ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆã¯æ­£ç¢ºãªæ—¥æœ¬èªã§è¡¨ç¤º
- æ–‡å­—ãŒèª­ã¿ã‚„ã™ã„ã‚ˆã†ã«ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã‚’ç¢ºä¿
${options.staffPhoto ? '- ã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã‚’å¿…ãšå«ã‚ã€å¹ãå‡ºã—ã«ã¯ç‰©ä»¶ã®é­…åŠ›ã‚’è¡¨ã™çŸ­ã„ã‚³ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆ' : ''}
${options.propertyImages.length > 1 ? '- æä¾›ã•ã‚ŒãŸå…¨ã¦ã®ç‰©ä»¶å†™çœŸã‚’ä½¿ç”¨' : ''}
`;
        }
        // ãƒ“ã‚¸ãƒã‚¹è³‡æ–™ãƒ¢ãƒ¼ãƒ‰ï¼ˆã‚¤ãƒ³ãƒ•ã‚©ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ï¼‰
        else if (options.mode === 'document' && options.style === 'business') {
            console.log('Using business document prompt');
            prompt = `
æ—¥æœ¬èªã®ãƒ“ã‚¸ãƒã‚¹ææ¡ˆæ›¸ã‚¹ã‚¿ã‚¤ãƒ«ã®ä¸å‹•ç”£ã‚¤ãƒ³ãƒ•ã‚©ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
1æšã§å…¨ã¦ã®ç‰©ä»¶æƒ…å ±ãŒä¼ã‚ã‚‹ã€ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªè³‡æ–™ãƒ‡ã‚¶ã‚¤ãƒ³ã§ã™ã€‚

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ç‰©ä»¶å: ${propertyDetails.title}
å®¶è³ƒ: ${propertyDetails.price}
æ•·é‡‘/ç¤¼é‡‘: ${propertyDetails.deposit}
é–“å–ã‚Š: ${propertyDetails.layout}
æ‰€åœ¨åœ°: ${propertyDetails.address}
é§è»Šå ´: ${propertyDetails.parking}
ãƒšãƒƒãƒˆ: ${propertyDetails.pet}
å»ºç‰©æ§‹é€ : ${propertyDetails.building}
ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: ${propertyDetails.security}
è¨­å‚™: ${propertyDetails.equipment}
ãƒã‚¹ãƒ»ãƒˆã‚¤ãƒ¬: ${propertyDetails.bath}
ã‚­ãƒƒãƒãƒ³: ${propertyDetails.kitchen}
åç´: ${propertyDetails.storage}
ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ: ${propertyDetails.internet}
ä¸å‹•ç”£ä¼šç¤¾: ${propertyDetails.company}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€ã‚¤ãƒ³ãƒ•ã‚©ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã€‘ç´ºè‰²èƒŒæ™¯                      â”‚
â”‚  ğŸ  ${propertyDetails.title}             â”‚
â”‚  ğŸ’° ${propertyDetails.price} â†ç›®ç«‹ã¤å¤§æ–‡å­— â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚                      â”‚
â”‚  ã€ãƒ¡ã‚¤ãƒ³å†™çœŸã€‘   â”‚  ã€åŸºæœ¬æƒ…å ±ã‚«ãƒ¼ãƒ‰ã€‘    â”‚
â”‚  ç‰©ä»¶å¤–è¦³/å†…è¦³   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                 â”‚  â”‚ğŸ  é–“å–ã‚Š        â”‚  â”‚
â”‚                 â”‚  â”‚${propertyDetails.layout}â”‚
â”‚                 â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚                 â”‚  â”‚ğŸ“ æ‰€åœ¨åœ°        â”‚  â”‚
â”‚                 â”‚  â”‚${propertyDetails.address}â”‚
â”‚                 â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚                 â”‚  â”‚ğŸš— é§è»Šå ´        â”‚  â”‚
â”‚                 â”‚  â”‚${propertyDetails.parking}â”‚
â”‚                 â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ã€è¨­å‚™ãƒ»ç‰¹å¾´ã‚¢ã‚¤ã‚³ãƒ³ã€‘æ¨ªä¸¦ã³              â”‚
â”‚  ğŸ”ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£  ğŸ•ãƒšãƒƒãƒˆ  ğŸ³ã‚­ãƒƒãƒãƒ³      â”‚
â”‚  ğŸ›ãƒã‚¹ãƒˆã‚¤ãƒ¬   ğŸ“ºã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ã€è²»ç”¨è©³ç´°ã€‘3ã‚«ãƒ©ãƒ                       â”‚
â”‚  æ•·é‡‘ â”‚ ç¤¼é‡‘ â”‚ ä»²ä»‹æ‰‹æ•°æ–™                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ã€ãƒ•ãƒƒã‚¿ãƒ¼ã€‘                            â”‚
â”‚  ğŸ¢ ${propertyDetails.company}          â”‚
â”‚  ğŸ“ ãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰ [ãƒœã‚¿ãƒ³]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€ãƒ‡ã‚¶ã‚¤ãƒ³ä»•æ§˜ã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
- ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ : 
  - ãƒ¡ã‚¤ãƒ³: ç´ºè‰² (#1e3a5f)
  - ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ: é»„è‰² (#ffd700)ã€æ°´è‰² (#87ceeb)
  - èƒŒæ™¯: ç™½ (#ffffff)
  - ãƒ†ã‚­ã‚¹ãƒˆ: æ¿ƒã„ç°è‰² (#333333)

- ã‚¢ã‚¤ã‚³ãƒ³: å„æƒ…å ±é …ç›®ã«ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä»˜ä¸
- ã‚«ãƒ¼ãƒ‰: æƒ…å ±ã‚’ã‚«ãƒ¼ãƒ‰å½¢å¼ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
- çŸ¢å°/ãƒ•ãƒ­ãƒ¼: æƒ…å ±ã®æµã‚Œã‚’è¦–è¦šåŒ–
- ãƒãƒƒã‚¸: ã€ŒãŠã™ã™ã‚ã€ã€Œæ–°ç€ã€ãªã©ã®ãƒ©ãƒ™ãƒ«

- ãƒ•ã‚©ãƒ³ãƒˆ: 
  - ã‚¿ã‚¤ãƒˆãƒ«: å¤ªå­—ã€å¤§ãã‚
  - æœ¬æ–‡: èª­ã¿ã‚„ã™ã„æ¨™æº–ã‚µã‚¤ã‚º
  - ä¾¡æ ¼: æœ€ã‚‚ç›®ç«‹ã¤ã‚µã‚¤ã‚º

- è¦–è¦šçš„è¦ç´ :
  - ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ï¼ˆå¾®å¦™ã«ï¼‰
  - ãƒ‰ãƒ­ãƒƒãƒ—ã‚·ãƒ£ãƒ‰ã‚¦ï¼ˆã‚«ãƒ¼ãƒ‰ã«æ·±ã¿ï¼‰
  - åŒºåˆ‡ã‚Šç·šï¼ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ†ã‘ï¼‰

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€å¿…é ˆè¡¨ç¤ºæ–‡å­—ï¼ˆæ­£ç¢ºã«æ—¥æœ¬èªã§ï¼‰ã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€Œ${propertyDetails.title}ã€
ã€Œ${propertyDetails.price}ã€
ã€Œ${propertyDetails.layout}ã€
ã€Œ${propertyDetails.address}ã€
ã€Œ${propertyDetails.parking}ã€
ã€Œ${propertyDetails.deposit}ã€
ã€Œ${propertyDetails.company}ã€
ã€ŒãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰ã€

ã€é‡è¦ã€‘
- å…¨ãƒ†ã‚­ã‚¹ãƒˆã¯æ­£ç¢ºãªæ—¥æœ¬èªã§è¡¨ç¤º
- æ–‡å­—åŒ–ã‘ã‚„å´©ã‚Œãªã—
- ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ“ã‚¸ãƒã‚¹è³‡æ–™å“è³ª
- å°åˆ·ã—ã¦ã‚‚èª­ã¿ã‚„ã™ã„ãƒ‡ã‚¶ã‚¤ãƒ³
- ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”: ${options.aspectRatio}
${options.staffPhoto ? `
ã€ã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã®åŠ å·¥ãƒ»é…ç½®ã€‘
- æä¾›ã•ã‚ŒãŸã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã‚’ã€Œæ¡ˆå†…ãƒãƒ¼ã‚ºã€ã«åŠ å·¥
- æ‰‹ã‚’ç‰©ä»¶å†™çœŸã®æ–¹å‘ã«å·®ã—å‡ºã—ã€æ¡ˆå†…ã—ã¦ã„ã‚‹é›°å›²æ°—ã«
- æ˜ã‚‹ã„ç¬‘é¡”ã§è¦ªã—ã¿ã‚„ã™ã„è¡¨æƒ…ï¼ˆå¿…ãšç¬‘é¡”ã«ã™ã‚‹ï¼‰
- æ­¯ã‚’è¦‹ã›ãŸè‡ªç„¶ãªç¬‘é¡”ã§ç‰©ä»¶ã‚’ç´¹ä»‹ã—ã¦ã„ã‚‹ãƒãƒ¼ã‚º
- å³ä¸‹ã«é…ç½®ã€å††å½¢ãƒ•ãƒ¬ãƒ¼ãƒ ã§å›²ã‚€
- å¹ãå‡ºã—ã§ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ ` : ''}
`;
        } else if (options.mode === 'infographic') {
            // ã‚¤ãƒ³ãƒ•ã‚©ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯å°‚ç”¨ãƒ¢ãƒ¼ãƒ‰
            console.log('Using infographic prompt');
            prompt = `
æ—¥æœ¬èªã®ä¸å‹•ç”£ã‚¤ãƒ³ãƒ•ã‚©ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
ãƒ“ã‚¸ãƒã‚¹ææ¡ˆæ›¸ã‚„ç´™è³‡æ–™ã«ä½¿ãˆã‚‹ã€1æšã§å…¨æƒ…å ±ãŒä¼ã‚ã‚‹ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³ã§ã™ã€‚

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ï¼ˆå…¨ã¦ç”»åƒã«å«ã‚ã‚‹ï¼‰ã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ  ç‰©ä»¶å: ${propertyDetails.title}
ğŸ’° å®¶è³ƒ: ${propertyDetails.price}
ğŸ“ æ•·é‡‘/ç¤¼é‡‘: ${propertyDetails.deposit}
ğŸ  é–“å–ã‚Š: ${propertyDetails.layout}
ğŸ“ æ‰€åœ¨åœ°: ${propertyDetails.address}
ğŸš— é§è»Šå ´: ${propertyDetails.parking}
ğŸ• ãƒšãƒƒãƒˆ: ${propertyDetails.pet}
ğŸ—ï¸ å»ºç‰©æ§‹é€ : ${propertyDetails.building}
ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: ${propertyDetails.security}
ğŸ“º è¨­å‚™: ${propertyDetails.equipment}
ğŸ› ãƒã‚¹ãƒ»ãƒˆã‚¤ãƒ¬: ${propertyDetails.bath}
ğŸ³ ã‚­ãƒƒãƒãƒ³: ${propertyDetails.kitchen}
ğŸ“¦ åç´: ${propertyDetails.storage}
ğŸŒ ãƒãƒƒãƒˆ: ${propertyDetails.internet}
ğŸ¢ ä¸å‹•ç”£ä¼šç¤¾: ${propertyDetails.company}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€ã‚¤ãƒ³ãƒ•ã‚©ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯æ§‹æˆã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ  ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã€‘                                â”ƒ
â”ƒ  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”ƒ
â”ƒ  ç‰©ä»¶å: ${propertyDetails.title}                    â”ƒ
â”ƒ  â˜… ${propertyDetails.price} â˜… â†æœ€å¤§ã‚µã‚¤ã‚ºã€é»„è‰²èƒŒæ™¯  â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
              â†“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                  â”ƒ                                  â”ƒ
â”ƒ  ã€ç‰©ä»¶å†™çœŸã€‘     â”ƒ  ã€ç‰©ä»¶ã‚¹ãƒšãƒƒã‚¯ã€‘                  â”ƒ
â”ƒ                  â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”ƒ
â”ƒ  æä¾›ã•ã‚ŒãŸå†™çœŸ   â”ƒ  â”‚ ğŸ  ${propertyDetails.layout}â”‚   â”ƒ
â”ƒ  ã‚’å¤§ããé…ç½®    â”ƒ  â”‚ ğŸ“ ${propertyDetails.address}â”‚  â”ƒ
â”ƒ                  â”ƒ  â”‚ ğŸš— ${propertyDetails.parking}â”‚  â”ƒ
â”ƒ                  â”ƒ  â”‚ ğŸ• ${propertyDetails.pet}   â”‚   â”ƒ
â”ƒ                  â”ƒ  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”ƒ
â”ƒ                  â”ƒ                                  â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
              â†“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ  ã€è¨­å‚™ãƒ»ç‰¹å¾´ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã€‘ã‚¢ã‚¤ã‚³ãƒ³ä»˜ãã‚°ãƒªãƒƒãƒ‰         â”ƒ
â”ƒ  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”          â”ƒ
â”ƒ  â”‚ğŸ”  â”‚ â”‚ğŸ›  â”‚ â”‚ğŸ³  â”‚ â”‚ğŸ“º  â”‚ â”‚ğŸ“¦  â”‚          â”ƒ
â”ƒ  â”‚ã‚»ã‚­ãƒ¥â”‚ â”‚ãƒã‚¹ â”‚ â”‚ã‚­ãƒƒãƒâ”‚ â”‚ãƒãƒƒãƒˆâ”‚ â”‚åç´ â”‚          â”ƒ
â”ƒ  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜          â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
              â†“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ  ã€è²»ç”¨è©³ç´°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã€‘3ã‚«ãƒ©ãƒ æ¯”è¼ƒè¡¨                  â”ƒ
â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”                  â”ƒ
â”ƒ  â”‚ æ•·é‡‘  â”‚  â”‚ ç¤¼é‡‘  â”‚  â”‚ æ‰‹æ•°æ–™ â”‚                  â”ƒ
â”ƒ  â”‚${propertyDetails.deposit}â”‚                       â”ƒ
â”ƒ  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜                  â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
              â†“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ  ã€ãƒ•ãƒƒã‚¿ãƒ¼ã€‘                                       â”ƒ
â”ƒ  ğŸ¢ ${propertyDetails.company}                     â”ƒ
â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”ƒ
â”ƒ  â”‚  ğŸ“ ãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰  â†’              â”‚      â”ƒ
â”ƒ  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€ãƒ‡ã‚¶ã‚¤ãƒ³ä»•æ§˜ã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ:
- ãƒ—ãƒ©ã‚¤ãƒãƒª: ç´ºè‰² (#1a365d)
- ã‚»ã‚«ãƒ³ãƒ€ãƒª: æ°´è‰² (#63b3ed)
- ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ: é»„è‰²/ã‚´ãƒ¼ãƒ«ãƒ‰ (#f6e05e)
- èƒŒæ™¯: ç™½/è–„ã„ã‚°ãƒ¬ãƒ¼ (#f7fafc)
- ãƒ†ã‚­ã‚¹ãƒˆ: ãƒ€ãƒ¼ã‚¯ã‚°ãƒ¬ãƒ¼ (#2d3748)

ãƒ‡ã‚¶ã‚¤ãƒ³è¦ç´ :
- å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯è§’ä¸¸ã®ã‚«ãƒ¼ãƒ‰ã§å›²ã‚€
- ã‚¢ã‚¤ã‚³ãƒ³ã¯å††å½¢èƒŒæ™¯ä»˜ã
- çŸ¢å°ã‚„ãƒ•ãƒ­ãƒ¼ãƒ©ã‚¤ãƒ³ã§æƒ…å ±ã®æµã‚Œã‚’è¡¨ç¾
- ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ï¼ˆå¾®å¦™ã«ï¼‰
- é©åº¦ãªä½™ç™½ã¨ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°
- å½±åŠ¹æœã§ã‚«ãƒ¼ãƒ‰ã«æ·±ã¿ã‚’å‡ºã™

ãƒ•ã‚©ãƒ³ãƒˆ:
- ã‚¿ã‚¤ãƒˆãƒ«: å¤ªå­—ã€24-32ptç›¸å½“
- ä¾¡æ ¼: æœ€å¤§ã€å¤ªå­—ã€36-48ptç›¸å½“ã€ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚«ãƒ©ãƒ¼
- æœ¬æ–‡: 12-14ptç›¸å½“ã€èª­ã¿ã‚„ã™ã•é‡è¦–
- ãƒ©ãƒ™ãƒ«: 10-12ptç›¸å½“ã€ã‚°ãƒ¬ãƒ¼

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€å¿…é ˆè¡¨ç¤ºãƒ†ã‚­ã‚¹ãƒˆï¼ˆæ­£ç¢ºã«æ—¥æœ¬èªã§ï¼‰ã€‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ã€Œ${propertyDetails.title}ã€
ã€Œ${propertyDetails.price}ã€
ã€Œ${propertyDetails.layout}ã€
ã€Œ${propertyDetails.address}ã€
ã€Œ${propertyDetails.parking}ã€
ã€Œ${propertyDetails.deposit}ã€
ã€Œ${propertyDetails.company}ã€
ã€ŒãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰ã€

ã€é‡è¦ãªæŒ‡ç¤ºã€‘
- å…¨ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆã¯æ­£ç¢ºãªæ—¥æœ¬èªã§è¡¨ç¤ºã™ã‚‹ã“ã¨
- æ–‡å­—åŒ–ã‘ã€å´©ã‚Œã€èª¤å­—ã¯çµ¶å¯¾ã«é¿ã‘ã‚‹
- ãƒ“ã‚¸ãƒã‚¹è³‡æ–™ã¨ã—ã¦å°åˆ·å¯èƒ½ãªå“è³ª
- æƒ…å ±ã®éšå±¤ãŒæ˜ç¢ºã«åˆ†ã‹ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³
- 1æšã§ç‰©ä»¶ã®å…¨ã¦ãŒåˆ†ã‹ã‚‹å®Œçµã—ãŸãƒ‡ã‚¶ã‚¤ãƒ³
- ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”: ${options.aspectRatio}
${options.staffPhoto ? `
ã€ã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã®åŠ å·¥ãƒ»é…ç½®ã€‘
- æä¾›ã•ã‚ŒãŸã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã‚’ã€Œæ¡ˆå†…ãƒãƒ¼ã‚ºã€ã«åŠ å·¥
- æ‰‹ã‚’ç‰©ä»¶å†™çœŸã®æ–¹å‘ã«å·®ã—å‡ºã—ã€æ¡ˆå†…ã—ã¦ã„ã‚‹é›°å›²æ°—ã«
- æ˜ã‚‹ã„ç¬‘é¡”ã§è¦ªã—ã¿ã‚„ã™ã„è¡¨æƒ…ï¼ˆå¿…ãšç¬‘é¡”ã«ã™ã‚‹ï¼‰
- æ­¯ã‚’è¦‹ã›ãŸè‡ªç„¶ãªç¬‘é¡”ã§ç‰©ä»¶ã‚’ç´¹ä»‹ã—ã¦ã„ã‚‹ãƒãƒ¼ã‚º
- ãƒ•ãƒƒã‚¿ãƒ¼ä»˜è¿‘ã«é…ç½®ã€å††å½¢ãƒ•ãƒ¬ãƒ¼ãƒ ã§å›²ã‚€
- å¹ãå‡ºã—ã§ã€ŒãŠã™ã™ã‚ã§ã™ï¼ã€ãªã©ã®ã‚³ãƒ¡ãƒ³ãƒˆ` : ''}
`;
        } else if (options.staffPhoto) {
            console.log('Using staff photo prompt');
            prompt = `
1æšã§ç‰©ä»¶ç´¹ä»‹ãŒã§ãã‚‹ä¸å‹•ç”£ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ç”»åƒã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
ã‚¹ã‚¿ãƒƒãƒ•ãŒç‰©ä»¶ã‚’ç´¹ä»‹ã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ã§ã€‚

ã€ç‰©ä»¶æƒ…å ±ï¼ˆå…¨ã¦ç”»åƒã«å«ã‚ã‚‹ï¼‰ã€‘
ğŸ“ ç‰©ä»¶å: ${propertyDetails.title}
ğŸ’° å®¶è³ƒ: ${propertyDetails.price}
ğŸ  é–“å–ã‚Š: ${propertyDetails.layout}
ğŸ“ æ‰€åœ¨åœ°: ${propertyDetails.address}
ğŸš— é§è»Šå ´: ${propertyDetails.parking}
ğŸ• ãƒšãƒƒãƒˆ: ${propertyDetails.pet}
ğŸ¢ ä¸å‹•ç”£ä¼šç¤¾: ${propertyDetails.company}

ã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘
- å·¦å´ã¾ãŸã¯èƒŒæ™¯: ç‰©ä»¶å†™çœŸ${options.propertyImages.length > 1 ? `ï¼ˆæä¾›ã•ã‚ŒãŸ${options.propertyImages.length}æšå…¨ã¦ã‚’ä½¿ç”¨ï¼‰` : ''}
- å³ä¸‹: ã‚¹ã‚¿ãƒƒãƒ•å†™çœŸï¼ˆå††å½¢ãƒ•ãƒ¬ãƒ¼ãƒ ã€ç™½ã„ç¸å–ã‚Šï¼‰
- ã‚¹ã‚¿ãƒƒãƒ•ã®å¹ãå‡ºã—ã«ç‰©ä»¶ã®é­…åŠ›ã‚’è¡¨ã™ã‚³ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆ
- ä¸Šéƒ¨: ç‰©ä»¶åã¨å®¶è³ƒï¼ˆå¤§ããç›®ç«‹ã¤ï¼‰
- ä¸­å¤®ã¾ãŸã¯å´é¢: ç‰©ä»¶æƒ…å ±ãƒªã‚¹ãƒˆ
- ä¸‹éƒ¨: ã€ŒãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰ã€ãƒœã‚¿ãƒ³

ã€ã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã®åŠ å·¥ - æœ€é‡è¦ã€‘
æä¾›ã•ã‚ŒãŸã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«åŠ å·¥ã—ã¦ãã ã•ã„ï¼š
- ã‚¹ã‚¿ãƒƒãƒ•ãŒã€Œç‰©ä»¶ã‚’æ¡ˆå†…ã—ã¦ã„ã‚‹ã€é›°å›²æ°—ã«åŠ å·¥
- æ‰‹ã‚’ç‰©ä»¶å†™çœŸã®æ–¹å‘ã«å·®ã—å‡ºã—ã€æ¡ˆå†…ã—ã¦ã„ã‚‹ãƒãƒ¼ã‚ºã«å¤‰æ›´
- ã€Œã“ã¡ã‚‰ã®ç‰©ä»¶ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€ã¨è¨€ã£ã¦ã„ã‚‹ã‚ˆã†ãªè‡ªç„¶ãªãƒãƒ¼ã‚º
- æ˜ã‚‹ã„ç¬‘é¡”ã§è¦ªã—ã¿ã‚„ã™ã„è¡¨æƒ…ï¼ˆå¿…ãšç¬‘é¡”ã«ã™ã‚‹ï¼‰
- æ­¯ã‚’è¦‹ã›ãŸè‡ªç„¶ãªç¬‘é¡”ãŒæœ›ã¾ã—ã„
- ä¸å‹•ç”£å–¶æ¥­ã‚¹ã‚¿ãƒƒãƒ•ã¨ã—ã¦ç‰©ä»¶ã‚’ç´¹ä»‹ã—ã¦ã„ã‚‹é›°å›²æ°—

ã€å¹ãå‡ºã—ã‚³ãƒ¡ãƒ³ãƒˆ - AIã§ç”Ÿæˆã€‘
ç‰©ä»¶ã®ç‰¹å¾´ã‚’åˆ†æã—ã¦ã€é­…åŠ›çš„ãªä¸€è¨€ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ—¥æœ¬èªã§ç”Ÿæˆã—ã¦ãã ã•ã„ï¼ˆ10æ–‡å­—ä»¥å†…ï¼‰
ä¾‹ï¼š
- é§è»Šå ´${propertyDetails.parking} â†’ ã€Œé§è»Šå ´åºƒã€…ï¼ã€
- ãƒšãƒƒãƒˆ${propertyDetails.pet} â†’ ã€ŒãƒšãƒƒãƒˆOKï¼ã€
- ä¾¡æ ¼ãŒãŠå¾— â†’ ã€ŒãŠå¾—ãªç‰©ä»¶ï¼ã€
- ç«‹åœ°ãŒè‰¯ã„ â†’ ã€Œä¾¿åˆ©ãªç«‹åœ°ï¼ã€

ã€è¡¨ç¤ºã™ã‚‹æ–‡å­—ï¼ˆæ­£ç¢ºã«æ—¥æœ¬èªã§ï¼‰ã€‘
- ã€Œ${propertyDetails.title}ã€
- ã€Œ${propertyDetails.price}ã€ï¼ˆæœ€ã‚‚ç›®ç«‹ã¤ã‚ˆã†ã«ï¼‰
- ã€Œ${propertyDetails.layout}ã€
- ã€Œ${propertyDetails.parking}ã€
- ã€ŒãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰ã€
- ã‚¹ã‚¿ãƒƒãƒ•å¹ãå‡ºã—: ç‰©ä»¶ã®ç‰¹å¾´ã«åŸºã¥ã„ãŸçŸ­ã„ã‚³ãƒ¡ãƒ³ãƒˆ

ã€ã‚¹ã‚¿ã‚¤ãƒ«ã€‘
${getStyleDescription(options.style)}
ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”: ${options.aspectRatio}

ã€é‡è¦ã€‘
- å…¨ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆã¯æ­£ç¢ºãªæ—¥æœ¬èªã§è¡¨ç¤º
- 1æšã§ç‰©ä»¶ã®é­…åŠ›ãŒä¼ã‚ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³
- ã‚¹ã‚¿ãƒƒãƒ•å†™çœŸã¯ã€Œæ¡ˆå†…ãƒãƒ¼ã‚ºã€ã«åŠ å·¥ï¼ˆæ‰‹ã‚’å·®ã—å‡ºã—ã¦ç‰©ä»¶ã‚’ç´¹ä»‹ã—ã¦ã„ã‚‹é›°å›²æ°—ï¼‰
- ã‚¹ã‚¿ãƒƒãƒ•ã®å¹ãå‡ºã—ã«ã¯ç‰©ä»¶ã®é­…åŠ›ã‚’è¡¨ã™çŸ­ã„ã‚³ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆ
${options.propertyImages.length > 1 ? `- æä¾›ã•ã‚ŒãŸ${options.propertyImages.length}æšã®ç‰©ä»¶å†™çœŸã‚’å…¨ã¦ä½¿ç”¨` : ''}
`;
        } else {
            console.log('Using default prompt');
            prompt = `
1æšã§ç‰©ä»¶ç´¹ä»‹ãŒã§ãã‚‹ä¸å‹•ç”£ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ç”»åƒã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ã€ç‰©ä»¶æƒ…å ±ï¼ˆå…¨ã¦ç”»åƒã«å«ã‚ã‚‹ï¼‰ã€‘
ğŸ“ ç‰©ä»¶å: ${propertyDetails.title}
ğŸ’° å®¶è³ƒ: ${propertyDetails.price}
ğŸ  é–“å–ã‚Š: ${propertyDetails.layout}
ğŸ“ æ‰€åœ¨åœ°: ${propertyDetails.address}
ğŸš— é§è»Šå ´: ${propertyDetails.parking}
ğŸ• ãƒšãƒƒãƒˆ: ${propertyDetails.pet}

ã€ä¸»è¦ãƒã‚¤ãƒ³ãƒˆã€‘
${highlights.join('\n')}

ã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘
- èƒŒæ™¯: ç‰©ä»¶å†™çœŸï¼ˆæä¾›ã•ã‚ŒãŸç”»åƒã‚’ä½¿ç”¨ï¼‰
- ä¸Šéƒ¨: ç‰©ä»¶åï¼ˆå¤§ããç›®ç«‹ã¤ç™½æ–‡å­—ã€å½±ä»˜ãï¼‰
- ä¸­å¤®: å®¶è³ƒï¼ˆæœ€ã‚‚ç›®ç«‹ã¤ã€ãƒãƒƒã‚¸ã¾ãŸã¯ãƒªãƒœãƒ³é¢¨ï¼‰
- ä¸‹éƒ¨ã¾ãŸã¯å´é¢: ç‰©ä»¶è©³ç´°ï¼ˆé–“å–ã‚Šã€é§è»Šå ´ãªã©ï¼‰
- æœ€ä¸‹éƒ¨: ã€ŒãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰ã€ãƒœã‚¿ãƒ³

ã€è¡¨ç¤ºã™ã‚‹æ–‡å­—ï¼ˆæ­£ç¢ºã«æ—¥æœ¬èªã§ï¼‰ã€‘
- ã€Œ${propertyDetails.title}ã€ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ï¼‰
- ã€Œ${propertyDetails.price}ã€ï¼ˆå®¶è³ƒã€æœ€ã‚‚å¤§ããï¼‰
- ã€Œ${propertyDetails.layout}ã€ï¼ˆé–“å–ã‚Šï¼‰
- ã€Œé§è»Šå ´ ${propertyDetails.parking}ã€
- ã€ŒãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰ã€ï¼ˆCTAãƒœã‚¿ãƒ³ï¼‰

ã€ã‚¹ã‚¿ã‚¤ãƒ«ã€‘
${getStyleDescription(options.style)}
- ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªä¸å‹•ç”£åºƒå‘Šãƒ‡ã‚¶ã‚¤ãƒ³
- èª­ã¿ã‚„ã™ã„ãƒ•ã‚©ãƒ³ãƒˆ
- ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”: ${options.aspectRatio}

ã€é‡è¦ã€‘
- å…¨ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆã¯æ­£ç¢ºãªæ—¥æœ¬èªã§è¡¨ç¤ºã™ã‚‹ã“ã¨
- æ–‡å­—ãŒèª­ã¿ã‚„ã™ã„ã‚ˆã†ã«ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã‚’ç¢ºä¿
- 1æšã§ç‰©ä»¶ã®é­…åŠ›ãŒå…¨ã¦ä¼ã‚ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³
`;
        }

        prompt += `\n\nç”»åƒä»•æ§˜: ${options.size}è§£åƒåº¦ã€${options.aspectRatio}ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã€‚`;

        // Build parts array with images
        const parts: any[] = [{ text: prompt }];

        // Add property images
        console.log(`Adding ${options.propertyImages.length} property images to prompt`);
        for (const img of options.propertyImages) {
            parts.push({
                inlineData: {
                    data: img.data,
                    mimeType: img.mimeType
                }
            });
        }

        // Add staff photo if provided
        if (options.staffPhoto) {
            console.log('Adding staff photo to prompt');
            parts.push({
                inlineData: {
                    data: options.staffPhoto.data,
                    mimeType: options.staffPhoto.mimeType
                }
            });
        }

        console.log(`Using model: ${modelConfig.name} (${modelConfig.id})`);
        
        // å¤ã„SDKã§ã®å‘¼ã³å‡ºã—
        const result = await model.generateContent({
            contents: [{ role: 'user', parts }],
        });

        const response = await result.response;

        // Extract image data from response
        const candidates = response.candidates;
        if (candidates && candidates[0]?.content?.parts) {
            for (const part of candidates[0].content.parts) {
                if (part.inlineData) {
                    return {
                        imageData: part.inlineData.data,
                        mimeType: part.inlineData.mimeType,
                        modelUsed: modelConfig.name,
                    };
                }
            }
        }

        throw new Error('No image generated');
    } catch (error) {
        console.error(`Image Generation with ${modelConfig.name} Error:`, error);
        throw error;
    }
}

// ============================================
// ç”»åƒç”Ÿæˆï¼ˆURLæŒ‡å®šãƒ»ãƒ¬ã‚¬ã‚·ãƒ¼ï¼‰
// ============================================
export async function generatePropertyImage(options: {
    propertyData: any;
    imageUrl: string;
    mode: 'sns_banner' | 'youtube_thumbnail' | 'document' | 'stories' | 'renovation' | 'comparison';
    size: '1K' | '2K' | '4K';
    aspectRatio: '1:1' | '16:9' | '9:16' | '4:3';
    style: string;
    includePrice?: boolean;
    includeLogo?: boolean;
    customText?: string;
    modelKey?: ImageModelKey;
}) {
    const modelKey = options.modelKey || 'gemini-3-pro';
    const modelConfig = AI_MODELS.image[modelKey];
    
    try {
        // å¤ã„SDKã‚’ä½¿ç”¨ï¼ˆresponseModalitiesã§ç”»åƒå‡ºåŠ›ã‚’æœ‰åŠ¹åŒ–ï¼‰
        const model = genAI.getGenerativeModel({
            model: modelConfig.id,
            generationConfig: {
                temperature: 1.0,
                // @ts-ignore - responseModalities is valid for Gemini image models
                responseModalities: ['TEXT', 'IMAGE'],
            }
        });

        // Build prompt based on mode
        let prompt = '';

        switch (options.mode) {
            case 'sns_banner':
                prompt = `
Create a professional real estate social media banner image with the following specifications:

Property Information:
- Title: ${options.propertyData.title}
- Price: ${options.propertyData.price}
- Category: ${options.propertyData.category_name_ja}

Design Requirements:
- Style: ${options.style} aesthetic - ${getStyleDescription(options.style)}
- Include the property image from the URL
- Add elegant text overlay with property title and price
- Add subtle gradient overlay for text readability
- Include "ãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰" call-to-action button
- Professional typography with Japanese fonts
- Aspect ratio: ${options.aspectRatio}

The image should be eye-catching and professional for Instagram/Facebook posts.
`;
                break;

            case 'youtube_thumbnail':
                prompt = `
Create a compelling YouTube thumbnail for a real estate property video:

Property: ${options.propertyData.title}
Price: ${options.propertyData.price}

Design Requirements:
- 16:9 aspect ratio optimized for YouTube
- Large, bold text that's readable even at small sizes
- Use the property image as background
- Add dramatic lighting and contrast
- Include price in a prominent badge/banner
- Add "æ–°ç€ç‰©ä»¶" or "å¿…è¦‹" badge
- ${options.style} design style
- High contrast for visibility

Make it click-worthy and professional.
`;
                break;

            case 'document':
                prompt = `
Create a professional A4-sized real estate property document/flyer:

Property Details:
${JSON.stringify(options.propertyData.property_data, null, 2)}

Design Requirements:
- Clean, professional layout suitable for printing
- Include property photo prominently
- Add detailed property information in organized sections
- Use ${options.style} design aesthetic
- Include company branding area
- Add QR code placeholder
- Professional typography
- 4:3 aspect ratio (A4 proportions)

Create a comprehensive property information sheet.
`;
                break;

            case 'stories':
                prompt = `
Create a vertical Instagram/LINE Stories image for real estate:

Property: ${options.propertyData.title}
Price: ${options.propertyData.price}

Design Requirements:
- 9:16 vertical aspect ratio
- Mobile-optimized design
- Property image as background with gradient overlay
- Large, readable text for mobile viewing
- Include swipe-up call-to-action
- ${options.style} aesthetic
- Add interactive elements (arrows, buttons)
- Optimized for quick viewing

Make it engaging for mobile users.
`;
                break;

            case 'renovation':
                prompt = `
Create a renovation visualization showing potential improvements:

Current Property: ${options.propertyData.title}

Design Requirements:
- Show the property with modern renovations applied
- ${options.style} interior design style
- Enhance lighting and atmosphere
- Add modern furniture and decor
- Improve color palette
- Show potential of the space
- Professional architectural visualization quality

Create an aspirational "after renovation" image.
`;
                break;

            case 'comparison':
                prompt = `
Create a before/after comparison image:

Property: ${options.propertyData.title}

Design Requirements:
- Split-screen or side-by-side layout
- Left: Current state
- Right: Renovated/improved version
- Clear "Before" and "After" labels
- ${options.style} design for the "after" side
- Professional presentation
- Add subtle divider line
- Include price and improvement highlights

Show the transformation potential clearly.
`;
                break;
        }

        if (options.customText) {
            prompt += `\n\nAdditional Instructions: ${options.customText}`;
        }

        // Add aspect ratio and size to the prompt instead of config
        prompt += `\n\nImage specifications: ${options.size} resolution, ${options.aspectRatio} aspect ratio.`;

        const parts: any[] = [{ text: prompt }];

        // If we have an image URL, include it
        if (options.imageUrl) {
            parts.push({
                text: `Use this property image as the base: ${options.imageUrl}`
            });
        }

        // å¤ã„SDKã§ã®å‘¼ã³å‡ºã—
        const result = await model.generateContent({
            contents: [{ role: 'user', parts }],
        });

        const response = await result.response;

        // Extract image data from response
        const candidates = response.candidates;
        if (candidates && candidates[0]?.content?.parts) {
            for (const part of candidates[0].content.parts) {
                if (part.inlineData) {
                    return {
                        imageData: part.inlineData.data,
                        mimeType: part.inlineData.mimeType,
                    };
                }
            }
        }

        throw new Error('No image generated');
    } catch (error) {
        console.error('Image Generation Error:', error);
        throw error;
    }
}
